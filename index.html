<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>日々籤｜凶之籤</title>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@300;600;900&display=swap');

        :root {
            --bg-color: #000000;
            --paper-color: #1a1a1a;
            --shrine-red: #d32f2f;
            --text-color: #e0e0e0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Noto Serif TC', serif;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .omikuji-strip {
            background-color: var(--paper-color);
            width: 90vw;
            max-width: 330px;
            height: 88vh;
            max-height: 700px;
            position: relative;
            box-shadow: 0 0 40px rgba(178, 69, 69, 0.2);
            display: flex;
            justify-content: center;
            align-items: center;
            animation: slideUp 2s cubic-bezier(0.22, 1, 0.36, 1);
        }

        .border-outer {
            position: absolute;
            inset: 0;
            border: 6px solid var(--shrine-red);
            pointer-events: none;
        }

        .border-inner {
            position: absolute;
            inset: 15px;
            border: 2.5px solid var(--shrine-red);
            opacity: 0.7;
            pointer-events: none;
        }

        .vertical-content {
            writing-mode: vertical-rl;
            text-orientation: upright;
            height: 100%;
            width: 100%;
            padding: 85px 60px 85px 170px;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .rank {
            font-size: 2.4rem;
            color: var(--shrine-red);
            font-weight: 900;
            margin-left: 2rem;
            margin-bottom: 2rem;
            letter-spacing: 0.25em;
        }

        .text-body {
            font-size: 1.05rem;
            line-height: 2.6;
            letter-spacing: 0.32em;
            font-weight: 300;
            max-width: 120px;
            opacity: 0.9;
        }

        .bottom-tag,
        .signature {
            position: absolute;
            bottom: 40px;
            writing-mode: vertical-rl;
            color: var(--shrine-red);
            letter-spacing: 0.3em;
            font-weight: 600;
        }

        .bottom-tag { left: 40px; font-size: 0.7rem; opacity: 0.6; }
        .signature { right: 40px; font-size: 0.82rem; opacity: 0.9; }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(120px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .hint {
            position: absolute;
            bottom: 2vh;
            font-size: 0.7rem;
            color: #444;
            letter-spacing: 0.15em;
        }
    </style>
</head>

<body>

<div class="omikuji-strip">
    <div class="border-outer"></div>
    <div class="border-inner"></div>

    <div class="vertical-content">
        <div class="rank" id="rank">--</div>
        <div class="text-body" id="content">正在祈請...</div>
    </div>

    <div class="bottom-tag">凶之籤</div>
    <div class="signature">日々籤</div>
</div>

<div class="hint" id="hint">重新整理頁面以求新籤</div>

<script>
    const data = {
        openings: [
            "此刻的風浪稍顯湍急，","當事情不如預期般順遂，","如果前方有厚重的雲霧，","在感受到阻礙的這段時日，",
            "當一切漸漸變得沈重，","若能在此刻收斂鋒芒，","面對那些突如其來的波折，","此刻並非大步行走的時機，"
        ],
        middles: [
            "請先學會溫柔地接納那個受挫的自己。","讓煩惱在時間的長河裡，安安靜靜地流走。",
            "不必恐懼停滯，生命自有它休養生息的節律。","守護好內心的那點微光，不被外物所侵蝕。"
        ],
        closings: [
            "等雨停後，路面會更加明亮。","不必急著證明什麼，時間自有定論。",
            "退後一步，便是海闊天空的開端。","願你在艱難的同時，依然擁有一顆平靜的心。"
        ],
        ranks: ["凶","末凶","大凶"]
    };

    const BLOCK_TEXT = "今日之籤已靜靜落定，請待明日再來。";

    function getTaiwanDateKey() {
        const now = new Date();
        const utc8 = new Date(now.getTime() + (8 * 60 * 60 * 1000));
        return utc8.toISOString().slice(0, 10); // YYYY-MM-DD
    }

    function generateFortune() {
        const o = data.openings[Math.floor(Math.random() * data.openings.length)];
        const m = data.middles[Math.floor(Math.random() * data.middles.length)];
        const c = data.closings[Math.floor(Math.random() * data.closings.length)];
        const r = data.ranks[Math.floor(Math.random() * data.ranks.length)];

        document.getElementById('rank').innerText = r;
        document.getElementById('content').innerText = o + m + c;
    }

    window.onload = () => {
        const todayKey = getTaiwanDateKey();
        const lastDraw = localStorage.getItem("omikuji-date");

        if (lastDraw === todayKey) {
            document.getElementById('rank').innerText = "—";
            document.getElementById('content').innerText = BLOCK_TEXT;
            document.getElementById('hint').innerText = "每日 00:00（UTC+8）重置";
        } else {
            generateFortune();
            localStorage.setItem("omikuji-date", todayKey);
        }
    };
</script>

</body>
</html>
